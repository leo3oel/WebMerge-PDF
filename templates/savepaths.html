{% extends "base.html" %}
{% block title %}Manage Save Paths{% endblock %}
{% block content %}
<div class="page-header">
  <h1>Save Paths</h1>
  <div class="header-actions">
    <button id="createBtn" type="button" class="btn btn-submit" data-url="{{ url_for('create_savepath', next=next) }}">ï¼‹ Create</button>
    <form method="get" action="{{ next or url_for('save') }}" style="margin:0;">
      <button type="submit" class="btn btn-back">Back</button>
    </form>
  </div>
</div>
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <ul class="flashes">
      {% for category, msg in messages %}
        <li class="{{ category }}">{{ msg }}</li>
      {% endfor %}
    </ul>
  {% endif %}
{% endwith %}

<div class="card">
  <table class="sp-table">
    <thead>
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Description</th>
        <th style="width:170px;">Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for sp in save_paths %}
      <tr>
        <td class="muted">{{ sp.id }}</td>
        <td>{{ sp.name }}</td>
        <td class="small-text">{{ sp.description }}</td>
        <td>
          <form method="get" action="{{ url_for('edit_savepath', sp_id=sp.id) }}" style="display:inline; margin:0;">
            <input type="hidden" name="next" value="{{ next }}">
            <button type="submit" class="btn">Edit</button>
          </form>
          <form method="post" action="{{ url_for('delete_savepath', sp_id=sp.id) }}" style="display:inline; margin:0;">
            <button type="submit"  class="btn btn-delete" onclick="return confirm('Delete this save path?')">Delete</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<script>
document.getElementById('createBtn').addEventListener('click', function () {
  const url = this.dataset.url;
  if (url) window.location = url;
});
</script>

{% endblock %}
